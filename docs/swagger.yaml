basePath: /
definitions:
  models.Division:
    properties:
      description:
        type: string
      id:
        type: integer
      name:
        type: string
      pinned:
        items:
          $ref: '#/definitions/models.Hole'
        type: array
      time_created:
        type: string
      time_updated:
        type: string
    type: object
  models.Floor:
    properties:
      anonyname:
        description: random username, not empty
        type: string
      content:
        description: not empty
        type: string
      deleted:
        description: whether the floor is deleted
        type: boolean
      fold:
        description: fold reason
        type: string
      hole_id:
        type: integer
      id:
        type: integer
      is_me:
        description: whether the user is the author of the floor, dynamically generated
        type: boolean
      like:
        description: like - dislike
        type: integer
      liked:
        description: whether the user has liked the floor, dynamically generated
        type: boolean
      mention:
        description: Many to many mentions (in different holes)
        items:
          $ref: '#/definitions/models.Floor'
        type: array
      reply_to:
        description: Floor id that it replies to (must be in the same hole)
        type: integer
      special_tag:
        description: Additional info
        type: string
      storey:
        description: The sequence of floors in a hole
        type: integer
      time_created:
        type: string
      time_updated:
        type: string
    type: object
  models.Hole:
    properties:
      division_id:
        type: integer
      floors:
        $ref: '#/definitions/models.HoleFloor'
        description: return floors
      hidden:
        type: boolean
      id:
        type: integer
      reply:
        type: integer
      tags:
        items:
          $ref: '#/definitions/models.Tag'
        type: array
      time_created:
        type: string
      time_updated:
        type: string
      view:
        type: integer
    type: object
  models.HoleFloor:
    properties:
      first_floor:
        $ref: '#/definitions/models.Floor'
      floors:
        items:
          $ref: '#/definitions/models.Floor'
        type: array
      last_floor:
        $ref: '#/definitions/models.Floor'
    type: object
  models.Tag:
    properties:
      id:
        type: integer
      name:
        type: string
      temperature:
        type: integer
      time_created:
        type: string
      time_updated:
        type: string
    type: object
  schemas.AddDivision:
    properties:
      description:
        type: string
      name:
        type: string
    type: object
  schemas.CreateFloor:
    properties:
      content:
        type: string
      reply_to:
        description: id of the floor to which replied
        type: integer
    type: object
  schemas.CreateFloorOld:
    properties:
      content:
        type: string
      hole_id:
        type: integer
      reply_to:
        description: id of the floor to which replied
        type: integer
    type: object
  schemas.CreateHole:
    properties:
      content:
        type: string
      tags:
        description: All users
        items:
          $ref: '#/definitions/schemas.CreateTag'
        type: array
    type: object
  schemas.CreateHoleOld:
    properties:
      content:
        type: string
      division_id:
        description: Admin only
        type: integer
      tags:
        description: All users
        items:
          $ref: '#/definitions/schemas.CreateTag'
        type: array
    type: object
  schemas.CreateTag:
    properties:
      name:
        description: Admin only
        type: string
    type: object
  schemas.DeleteDivision:
    properties:
      to:
        default: 1
        description: |-
          Admin only
          ID of the target division that all the deleted division's holes will be moved to
        type: integer
    type: object
  schemas.DeleteFloor:
    properties:
      delete_reason:
        type: string
    type: object
  schemas.DeleteTag:
    properties:
      to:
        description: |-
          Admin only
          Name of the target tag that all the deleted tag's holes will be connected to
        type: string
    type: object
  schemas.MessageModel:
    properties:
      message:
        type: string
    type: object
  schemas.ModifyDivision:
    properties:
      description:
        type: string
      name:
        type: string
      pinned:
        items:
          type: integer
        type: array
    type: object
  schemas.ModifyFloor:
    properties:
      content:
        description: Owner or admin, the original content should be moved to  floor_history
        type: string
      fold:
        description: Admin only
        type: string
      like:
        description: All user, deprecated, "add" is like, "cancel" is reset
        type: string
      special_tag:
        description: Admin only
        type: string
    type: object
  schemas.ModifyHole:
    properties:
      division_id:
        description: Admin only
        type: integer
      tags:
        description: All users
        items:
          $ref: '#/definitions/schemas.CreateTag'
        type: array
    type: object
  schemas.ModifyTag:
    properties:
      name:
        description: Admin only
        type: string
      temperature:
        description: Admin only
        type: integer
    type: object
info:
  contact:
    email: hasbai@fduhole.com
    name: Maintainer Shi Yue
  description: 'An Anonymous BBS \n Note: PUT methods are used to PARTLY update, and
    we don''t use PATCH method.'
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  title: Open Tree Hole
  version: 2.0.0
paths:
  /:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/schemas.MessageModel'
  /divisions:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Division'
            type: array
      summary: List All Divisions
      tags:
      - Division
    post:
      consumes:
      - application/json
      parameters:
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.AddDivision'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Division'
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Division'
      summary: Add A Division
      tags:
      - Division
  /divisions/{division_id}/holes:
    get:
      parameters:
      - description: division_id
        in: path
        name: division_id
        required: true
        type: integer
      - description: updated time < offset (default is now)
        in: query
        name: offset
        type: string
      - default: 10
        description: length of object array
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Hole'
            type: array
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: List Holes In A Division
      tags:
      - Hole
    post:
      description: Create a hole, create tags and floor binding to it and set the
        name mapping
      parameters:
      - description: division id
        in: path
        name: division_id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.CreateHole'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Hole'
      summary: Create A Hole
      tags:
      - Hole
  /divisions/{id}:
    delete:
      description: Delete a division and move all of its holes to another given division
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.DeleteDivision'
      produces:
      - application/json
      responses:
        "204":
          description: ""
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Delete A Division
      tags:
      - Division
    get:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Division'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Get Division
      tags:
      - Division
    put:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.ModifyDivision'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Division'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Modify A Division
      tags:
      - Division
  /floors:
    get:
      deprecated: true
      parameters:
      - in: query
        name: holeID
        type: integer
      - default: 0
        in: query
        name: offset
        type: integer
      - default: 20
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Floor'
            type: array
      summary: Old API for Listing Floors
      tags:
      - Floor
    post:
      deprecated: true
      parameters:
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.CreateFloorOld'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Floor'
      summary: Old API for Creating A Floor
      tags:
      - Floor
  /floors/{id}:
    delete:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.DeleteFloor'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Floor'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Delete A Floor
      tags:
      - Floor
    get:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Floor'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Get A Floor
      tags:
      - Floor
    put:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.ModifyFloor'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Floor'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Modify A Floor
      tags:
      - Floor
  /floors/{id}/like/{like}:
    post:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: 1 is like, 0 is reset, -1 is dislike
        in: path
        name: like
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Floor'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Modify A Floor's like
      tags:
      - Floor
  /holes:
    get:
      deprecated: true
      parameters:
      - in: query
        name: divisionID
        type: integer
      - in: query
        name: offset
        type: string
      - in: query
        name: size
        type: integer
      - in: query
        name: tag
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Hole'
            type: array
      summary: Old API for Listing Holes
      tags:
      - Hole
    post:
      deprecated: true
      parameters:
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.CreateHoleOld'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Hole'
      summary: Old API for Creating A Hole
      tags:
      - Hole
  /holes/{hole_id}/floors:
    get:
      parameters:
      - description: hole id
        in: path
        name: hole_id
        required: true
        type: integer
      - default: false
        description: Is descending order
        in: query
        name: desc
        type: boolean
      - default: 0
        description: offset of object array
        in: query
        name: offset
        type: integer
      - default: id
        description: Now only supports id
        in: query
        name: orderBy
        type: string
      - default: 10
        description: length of object array
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Floor'
            type: array
      summary: List Floors In A Hole
      tags:
      - Floor
    post:
      parameters:
      - description: hole id
        in: path
        name: hole_id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.CreateFloor'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Floor'
      summary: Create A Floor
      tags:
      - Floor
  /holes/{id}:
    delete:
      description: Hide a hole, but visible to admins. This may affect many floors,
        DO NOT ABUSE!!!
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "204":
          description: ""
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Delete A Hole
      tags:
      - Hole
    get:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Hole'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Get A Hole
      tags:
      - Hole
    patch:
      description: Add hole.view
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "204":
          description: ""
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Patch A Hole
      tags:
      - Hole
    put:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.ModifyHole'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Hole'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Modify A Hole
      tags:
      - Hole
  /tags:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Tag'
            type: array
      summary: List All Tags
      tags:
      - Tag
    post:
      parameters:
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.CreateTag'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Tag'
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Tag'
      summary: Create A Tag
      tags:
      - Tag
  /tags/{id}:
    delete:
      description: Delete a tag and link all of its holes to another given tag
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.DeleteTag'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Tag'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Delete A Tag
      tags:
      - Tag
    get:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Tag'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Get A Tag
      tags:
      - Tag
    put:
      parameters:
      - description: id
        in: path
        name: id
        required: true
        type: integer
      - description: json
        in: body
        name: json
        required: true
        schema:
          $ref: '#/definitions/schemas.ModifyTag'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Tag'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: Modify A Tag
      tags:
      - Tag
  /tags/{tag_name}/holes:
    get:
      parameters:
      - description: tag_name
        in: path
        name: tag_name
        required: true
        type: string
      - description: updated time < offset (default is now)
        in: query
        name: offset
        type: string
      - default: 10
        description: length of object array
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Hole'
            type: array
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/schemas.MessageModel'
      summary: List Holes By Tag
      tags:
      - Hole
securityDefinitions:
  ApiKeyAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
